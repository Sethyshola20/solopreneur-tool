module.exports=[57726,a=>{"use strict";var b=a.i(91346),c=a.i(30271),d=a.i(5718),e=a.i(21717),f=a.i(61751),g=a.i(82519),h=a.i(57409);let i=(0,h.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var j=a.i(98626);let k=(0,h.default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),l=(0,h.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),m=(0,h.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),n=(0,h.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),o=(0,h.default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),p=(0,h.default)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);var q=a.i(70308),r=a.i(74871),s=a.i(56225);let t=s.z.object({name:s.z.string().min(1,"Le nom est requis"),description:s.z.string().optional().nullable(),apiKey:s.z.string().min(1,"La clé API est requise"),webhookSecret:s.z.string().optional().nullable(),isActive:s.z.boolean().default(!0).nonoptional()});s.z.object({stripeAccountId:s.z.string().min(1,"Le compte Stripe est requis"),stripeProductId:s.z.string().min(1,"L'ID produit Stripe est requis"),stripePriceId:s.z.string().optional().nullable(),name:s.z.string().min(1,"Le nom est requis"),description:s.z.string().optional().nullable(),price:s.z.string().optional().nullable(),currency:s.z.string().default("EUR"),isRecurring:s.z.boolean().default(!1),billingPeriod:s.z.string().optional().nullable(),isActive:s.z.boolean().default(!0).nonoptional()});var u=a.i(19354),v=a.i(85058),w=a.i(71195),x=a.i(77486),y=a.i(4733);function z({open:a,onOpenChange:f,initialData:g,accountId:h}){let i=(0,d.useCreateStripeAccount)(),j=(0,d.useUpdateStripeAccount)(h||""),k=(0,q.useForm)({resolver:(0,r.zodResolver)(t),defaultValues:g||{name:"",description:"",apiKey:"",webhookSecret:"",isActive:!0}});(0,c.useEffect)(()=>{g?k.reset({...g}):k.reset({name:"",description:"",apiKey:"",webhookSecret:"",isActive:!0})},[g,k]);let l=async a=>{let b=h?j:i;x.toast.promise(b.mutateAsync(a).then(()=>{f(!1),k.reset()}),{loading:h?"Mise à jour...":"Ajout...",success:h?"Compte Stripe mis à jour !":"Compte Stripe ajouté !",error:a=>"Erreur: "+a.message})},m=i.isPending||j.isPending;return(0,b.jsx)(u.Dialog,{open:a,onOpenChange:f,children:(0,b.jsxs)(u.DialogContent,{className:"max-w-2xl",children:[(0,b.jsx)(u.DialogHeader,{children:(0,b.jsx)(u.DialogTitle,{children:h?"Modifier le compte Stripe":"Ajouter un compte Stripe"})}),(0,b.jsx)(v.Form,{...k,children:(0,b.jsxs)("form",{onSubmit:k.handleSubmit(l),className:"space-y-4",children:[(0,b.jsx)(v.FormField,{control:k.control,name:"name",render:({field:a})=>(0,b.jsxs)(v.FormItem,{children:[(0,b.jsx)(v.FormLabel,{children:"Nom *"}),(0,b.jsx)(v.FormControl,{children:(0,b.jsx)(w.Input,{placeholder:"Ex: SaaS Product A",...a})}),(0,b.jsx)(v.FormDescription,{children:"Un nom pour identifier ce compte Stripe"}),(0,b.jsx)(v.FormMessage,{})]})}),(0,b.jsx)(v.FormField,{control:k.control,name:"description",render:({field:a})=>(0,b.jsxs)(v.FormItem,{children:[(0,b.jsx)(v.FormLabel,{children:"Description"}),(0,b.jsx)(v.FormControl,{children:(0,b.jsx)(w.Input,{placeholder:"Description optionnelle",...a,value:a.value||""})}),(0,b.jsx)(v.FormMessage,{})]})}),(0,b.jsx)(v.FormField,{control:k.control,name:"apiKey",render:({field:a})=>(0,b.jsxs)(v.FormItem,{children:[(0,b.jsx)(v.FormLabel,{children:"Clé API Stripe *"}),(0,b.jsx)(v.FormControl,{children:(0,b.jsx)(w.Input,{type:"password",placeholder:"sk_...",...a})}),(0,b.jsx)(v.FormDescription,{children:"Votre clé secrète Stripe (sera chiffrée)"}),(0,b.jsx)(v.FormMessage,{})]})}),(0,b.jsx)(v.FormField,{control:k.control,name:"webhookSecret",render:({field:a})=>(0,b.jsxs)(v.FormItem,{children:[(0,b.jsx)(v.FormLabel,{children:"Webhook Secret"}),(0,b.jsx)(v.FormControl,{children:(0,b.jsx)(w.Input,{type:"password",placeholder:"whsec_...",...a,value:a.value||""})}),(0,b.jsx)(v.FormDescription,{children:"Secret du webhook Stripe (optionnel)"}),(0,b.jsx)(v.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>f(!1),children:"Annuler"}),(0,b.jsx)(e.Button,{type:"submit",disabled:m,children:m?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(y.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Enregistrement..."]}):"Enregistrer"})]})]})})]})})}var A=a.i(27473),B=a.i(81121),C=a.i(64006),D=a.i(7560),E=a.i(92766),F=a.i(88629);let G=(0,E.cva)("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function H({className:a,variant:c,asChild:d=!1,...e}){let f=(0,F.cn)(G({variant:c}),a);return d?(0,b.jsx)(D.Slot,{"data-slot":"badge",className:f,...e}):(0,b.jsx)("span",{"data-slot":"badge",className:f,...e})}var I=a.i(77303),J=a.i(92283);let K=({products:a})=>{let c=a?.slice(0,3)||[],d=(a?.length||0)-c.length;return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center text-xs font-medium text-muted-foreground",children:[(0,b.jsx)(p,{className:"mr-1.5 h-3.5 w-3.5"})," Produits (",a?.length||0,")"]}),(0,b.jsx)("div",{className:"space-y-1.5",children:c.map(a=>(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"truncate max-w-[65%] font-medium",children:a.name}),(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.price?new Intl.NumberFormat("fr-FR",{style:"currency",currency:a.currency}).format(Number(a.price)):"—"})]},a.id))}),d>0&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground italic",children:["+",d," autre",d>1?"s":""]})]})};function L(){let{data:a,isLoading:h}=(0,d.useStripeAccounts)(),{data:p}=(0,d.useProducts)(),q=(0,d.useSyncProducts)(),r=(0,d.useDeleteStripeAccount)(),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),[w,y]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),F=p?.reduce((a,b)=>(a[b.stripeAccountId]||(a[b.stripeAccountId]=[]),a[b.stripeAccountId].push(b),a),{});return h?(0,b.jsxs)("div",{className:"space-y-8 p-4 md:p-6 lg:p-8 max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(I.Skeleton,{className:"h-8 w-64"}),(0,b.jsx)(I.Skeleton,{className:"h-4 w-96"})]}),(0,b.jsx)("div",{className:"grid gap-12 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)(f.Card,{className:"w-[280px] min-h-[380px] flex flex-col transition-all hover:shadow-md",children:[(0,b.jsxs)(f.CardHeader,{className:"space-y-2 pb-4",children:[(0,b.jsx)(I.Skeleton,{className:"h-5 w-3/4"}),(0,b.jsx)(I.Skeleton,{className:"h-3 w-1/2"})]}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)(I.Skeleton,{className:"h-3 w-12"}),(0,b.jsx)(I.Skeleton,{className:"h-3 w-16"})]}),(0,b.jsx)(I.Skeleton,{className:"h-6 w-full"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(I.Skeleton,{className:"h-3 w-full"}),(0,b.jsx)(I.Skeleton,{className:"h-3 w-5/6"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)(I.Skeleton,{className:"h-9 w-full"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(I.Skeleton,{className:"h-9 w-full"}),(0,b.jsx)(I.Skeleton,{className:"h-9 w-full"})]}),(0,b.jsx)(I.Skeleton,{className:"h-9 w-full"})]})]})]},c))})]}):(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center pb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold",children:"Gestion des Comptes Stripe"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1 max-w-2xl",children:"Connectez vos comptes Stripe pour centraliser vos produits, revenus et statistiques."})]}),(0,b.jsxs)(e.Button,{onClick:()=>{t(!0),v(null)},size:"sm",className:"h-9 px-4 md:px-5",children:[(0,b.jsx)(g.Plus,{className:"mr-2 h-4 w-4"}),"Nouveau compte"]})]}),a?.length===0&&(0,b.jsxs)(f.Card,{className:"py-12 text-center",children:[(0,b.jsx)("div",{className:"mx-auto mb-4 h-14 w-14 flex items-center justify-center rounded-full bg-primary/10",children:(0,b.jsx)(k,{className:"h-7 w-7 text-primary"})}),(0,b.jsx)(f.CardTitle,{className:"text-xl mb-2",children:"Aucun compte Stripe connecté"}),(0,b.jsx)(f.CardDescription,{className:"max-w-md mx-auto mb-6",children:"Commencez par connecter votre premier compte pour synchroniser vos produits et suivre vos ventes."}),(0,b.jsxs)(e.Button,{onClick:()=>{t(!0),v(null)},size:"sm",className:"h-9 px-5",children:[(0,b.jsx)(g.Plus,{className:"mr-2 h-4 w-4"}),"Connecter un compte"]})]}),(0,b.jsx)("div",{className:"grid gap-12 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:a?.map(a=>{let c=F?.[a.id]||[],d=c.length,g=q.isPending&&q.variables===a.id,h=a.lastSyncAt?(0,A.format)(new Date(a.lastSyncAt),"dd MMM yyyy, HH:mm",{locale:B.fr}):"Jamais";return(0,b.jsxs)(f.Card,{className:"w-[280px] min-h-[380px] flex flex-col transition-all hover:shadow-md",children:[(0,b.jsx)(f.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex justify-between items-start gap-2",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)(f.CardTitle,{className:"text-base font-semibold truncate",children:a.name}),a.description&&(0,b.jsx)(f.CardDescription,{className:"text-xs line-clamp-2 mt-1",children:a.description})]}),(0,b.jsxs)(H,{variant:"outline",className:`px-2 py-0.5 text-xs font-medium ${a.isActive?"border-emerald-500 text-emerald-700 dark:text-emerald-400 dark:border-emerald-500":"border-muted-foreground/50 text-muted-foreground"}`,children:[a.isActive?(0,b.jsx)(l,{className:"mr-1 h-3 w-3 text-emerald-600"}):(0,b.jsx)(m,{className:"mr-1 h-3 w-3"}),a.isActive?"Actif":"Inactif"]})]})}),(0,b.jsxs)(f.CardContent,{className:"flex flex-col flex-1 gap-4 pb-5",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Produits"}),(0,b.jsx)("p",{className:"font-semibold",children:d})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Dernière synchro"}),(0,b.jsx)("p",{className:"font-semibold",children:h})]})]}),(0,b.jsx)(J.Separator,{}),(0,b.jsx)("div",{className:"flex-1 min-h-[80px]",children:(0,b.jsx)(K,{products:c})}),(0,b.jsxs)("div",{className:"space-y-2.5 mt-auto",children:[(0,b.jsxs)(e.Button,{onClick:()=>{var b,c;return b=a.id,c=a.name,void x.toast.promise(q.mutateAsync(b),{loading:`Synchronisation des produits pour ${c}…`,success:a=>`${a.count} produit${1!==a.count?"s":""} synchronis\xe9${1!==a.count?"s":""} !`,error:a=>"Erreur de synchronisation : "+a.message})},disabled:q.isPending,variant:"outline",size:"sm",className:"w-full h-10 font-medium",children:[(0,b.jsx)(i,{className:`mr-2 h-4 w-4 ${g?"animate-spin":""}`}),g?"Synchronisation…":"Synchroniser"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",className:"flex-1 h-10 font-medium",onClick:()=>{v(a),t(!0)},children:[(0,b.jsx)(o,{className:"mr-2 h-4 w-4"}),"Modifier"]}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",className:"flex-1 h-10 font-medium",asChild:!0,children:(0,b.jsxs)("a",{href:`https://dashboard.stripe.com/connect/accounts/${a.id}`,target:"_blank",rel:"noopener noreferrer",children:[(0,b.jsx)(n,{className:"mr-2 h-4 w-4"}),"Stripe"]})})]}),(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",className:"w-full h-10 text-destructive hover:text-destructive font-medium",onClick:()=>{E({id:a.id,name:a.name}),y(!0)},children:[(0,b.jsx)(j.Trash2,{className:"mr-2 h-4 w-4"}),"Déconnecter le compte"]})]})]})]},a.id)})}),(0,b.jsx)(z,{open:s,onOpenChange:t,initialData:u||void 0,accountId:u?.id}),(0,b.jsx)(C.AlertDialog,{open:w,onOpenChange:y,children:(0,b.jsxs)(C.AlertDialogContent,{children:[(0,b.jsxs)(C.AlertDialogHeader,{children:[(0,b.jsx)(C.AlertDialogTitle,{children:"Confirmer la suppression"}),(0,b.jsxs)(C.AlertDialogDescription,{children:["Vous êtes sur le point de supprimer le compte ",(0,b.jsx)("span",{className:"font-semibold",children:D?.name}),". Cette action est ",(0,b.jsx)("span",{className:"font-semibold",children:"irréversible"})," et supprimera toutes les données liées."]})]}),(0,b.jsxs)(C.AlertDialogFooter,{children:[(0,b.jsx)(C.AlertDialogCancel,{children:"Annuler"}),(0,b.jsx)(C.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:()=>{D&&(x.toast.promise(r.mutateAsync(D.id).then(()=>E(null)),{loading:"Deconnexion en cours…",success:" Compte Stripe deconnecté !",error:a=>" Erreur : "+a.message}),y(!1))},disabled:r.isPending,children:r.isPending?"Déconnexion en cours…":"Déconnecter le compte"})]})]})})]})}a.s(["default",()=>L],57726)}];

//# sourceMappingURL=Documents_Code_solopreneur-tool_apps_web_app_dashboard_stripe_page_tsx_ce7d8bea._.js.map