{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/const.ts"],"sourcesContent":["export const isLocal = process.env.NODE_ENV === 'development';"],"names":[],"mappings":";;;;AAAO,MAAM,UAAU,oDAAyB"}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/lib/db/auth-schema.ts"],"sourcesContent":["import { InferSelectModel } from \"drizzle-orm\";\nimport {\n    pgTable,\n    text,\n    timestamp,\n    boolean,\n    pgSchema,\n    integer,\n} from \"drizzle-orm/pg-core\";\n\nexport const user = pgTable(\"user\", {\n    id: text(\"id\").primaryKey(),\n    name: text(\"name\").notNull(),\n    email: text(\"email\").notNull().unique(),\n    emailVerified: boolean(\"email_verified\").default(false).notNull(),\n    image: text(\"image\"),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n    updatedAt: timestamp(\"updated_at\")\n        .defaultNow()\n        .$onUpdate(() => /* @__PURE__ */ new Date())\n        .notNull(),\n});\n\nexport type User = InferSelectModel<typeof user>;\n\nexport const session = pgTable(\"session\", {\n    id: text(\"id\").primaryKey(),\n    expiresAt: timestamp(\"expires_at\").notNull(),\n    token: text(\"token\").notNull().unique(),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n    updatedAt: timestamp(\"updated_at\")\n        .$onUpdate(() => /* @__PURE__ */ new Date())\n        .notNull(),\n    ipAddress: text(\"ip_address\"),\n    userAgent: text(\"user_agent\"),\n    userId: text(\"user_id\")\n        .notNull()\n        .references(() => user.id, { onDelete: \"cascade\" }),\n});\n\nexport const account = pgTable(\"account\", {\n    id: text(\"id\").primaryKey(),\n    accountId: text(\"account_id\").notNull(),\n    providerId: text(\"provider_id\").notNull(),\n    userId: text(\"user_id\")\n        .notNull()\n        .references(() => user.id, { onDelete: \"cascade\" }),\n    accessToken: text(\"access_token\"),\n    refreshToken: text(\"refresh_token\"),\n    idToken: text(\"id_token\"),\n    accessTokenExpiresAt: timestamp(\"access_token_expires_at\"),\n    refreshTokenExpiresAt: timestamp(\"refresh_token_expires_at\"),\n    scope: text(\"scope\"),\n    password: text(\"password\"),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n    updatedAt: timestamp(\"updated_at\")\n        .$onUpdate(() => /* @__PURE__ */ new Date())\n        .notNull(),\n});\n\nexport const verification = pgTable(\"verification\", {\n    id: text(\"id\").primaryKey(),\n    identifier: text(\"identifier\").notNull(),\n    value: text(\"value\").notNull(),\n    expiresAt: timestamp(\"expires_at\").notNull(),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n    updatedAt: timestamp(\"updated_at\")\n        .defaultNow()\n        .$onUpdate(() => /* @__PURE__ */ new Date())\n        .notNull(),\n});\n\nexport const apikey = pgTable(\"apikey\", {\n    id: text(\"id\").primaryKey(),\n    name: text(\"name\"),\n    start: text(\"start\"),\n    prefix: text(\"prefix\"),\n    key: text(\"key\").notNull(),\n    userId: text(\"user_id\")\n        .notNull()\n        .references(() => user.id, { onDelete: \"cascade\" }),\n    refillInterval: integer(\"refill_interval\"),\n    refillAmount: integer(\"refill_amount\"),\n    lastRefillAt: timestamp(\"last_refill_at\"),\n    enabled: boolean(\"enabled\").default(true),\n    rateLimitEnabled: boolean(\"rate_limit_enabled\").default(true),\n    rateLimitTimeWindow: integer(\"rate_limit_time_window\").default(3600000),\n    rateLimitMax: integer(\"rate_limit_max\").default(100),\n    requestCount: integer(\"request_count\").default(0),\n    remaining: integer(\"remaining\"),\n    lastRequest: timestamp(\"last_request\"),\n    expiresAt: timestamp(\"expires_at\"),\n    createdAt: timestamp(\"created_at\").notNull(),\n    updatedAt: timestamp(\"updated_at\").notNull(),\n    permissions: text(\"permissions\"),\n    metadata: text(\"metadata\"),\n});\n\nexport const authSchema = {\n    user,\n    session,\n    account,\n    verification,\n    apikey,\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/lib/db/schema.ts"],"sourcesContent":["import { pgTable, text, timestamp, boolean, integer, serial, date, decimal, pgEnum, varchar, real, primaryKey } from 'drizzle-orm/pg-core';\nimport { user } from \"./auth-schema\";\nimport { relations } from 'drizzle-orm';\n\n// --- Business Logic ---\n\nexport const clients = pgTable('clients', {\n    id: text('id').primaryKey(), // uuid\n    userId: text('user_id').notNull().references(() => user.id),\n    name: text('name').notNull(),\n    email: text('email'),\n    phone: text('phone'),\n    address: text('address'),\n    notes: text('notes'),\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n    updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const devis = pgTable('devis', {\n    id: text('id').primaryKey(),\n    userId: text('user_id').notNull().references(() => user.id),\n    clientId: text('client_id').notNull().references(() => clients.id),\n    number: text('number').notNull(), // DEV-YYYY-NNN\n    status: text('status').notNull().default('draft'), // draft, sent, accepted, rejected\n    date: date('date').notNull(),\n    validUntil: date('valid_until'),\n    total: decimal('total', { precision: 10, scale: 2 }).notNull().default('0'),\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n    updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const devisItems = pgTable('devis_items', {\n    id: text('id').primaryKey(),\n    devisId: text('devis_id').notNull().references(() => devis.id, { onDelete: 'cascade' }),\n    description: text('description').notNull(),\n    quantity: decimal('quantity', { precision: 10, scale: 2 }).notNull().default('1'),\n    price: decimal('price', { precision: 10, scale: 2 }).notNull().default('0'),\n    total: decimal('total', { precision: 10, scale: 2 }).notNull().default('0'),\n});\n\nexport const factures = pgTable('factures', {\n    id: text('id').primaryKey(),\n    userId: text('user_id').notNull().references(() => user.id),\n    clientId: text('client_id').notNull().references(() => clients.id),\n    devisId: text('devis_id').references(() => devis.id),\n\n    // Stripe Integration\n    stripeInvoiceId: text('stripe_invoice_id').unique(), // Stripe invoice ID\n    stripeCustomerId: text('stripe_customer_id'), // Stripe customer ID\n    stripeAccountId: text('stripe_account_id').references(() => stripeAccounts.id), // Which Stripe account this invoice belongs to\n\n    number: text('number').notNull(), // FAC-YYYY-NNN\n    status: text('status').notNull().default('pending'), // pending, paid, cancelled\n    date: date('date').notNull(),\n    dueDate: date('due_date'),\n    total: decimal('total', { precision: 10, scale: 2 }).notNull().default('0'),\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n    updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\nexport const facturesItems = pgTable('factures_items', {\n    id: text('id').primaryKey(),\n    factureId: text('facture_id').notNull().references(() => factures.id, { onDelete: 'cascade' }),\n    description: text('description').notNull(),\n    quantity: decimal('quantity', { precision: 10, scale: 2 }).notNull().default('1'),\n    price: decimal('price', { precision: 10, scale: 2 }).notNull().default('0'),\n    total: decimal('total', { precision: 10, scale: 2 }).notNull().default('0'),\n});\n\nexport const recettes = pgTable('recettes', {\n    id: text('id').primaryKey(),\n    userId: text('user_id').notNull().references(() => user.id),\n    factureId: text('facture_id').references(() => factures.id),\n    clientId: text('client_id').references(() => clients.id),\n    amount: decimal('amount', { precision: 10, scale: 2 }).notNull(),\n    date: date('date').notNull(),\n    paymentMethod: text('payment_method'), // virement, cheque, especes, etc.\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\nexport const settings = pgTable('settings', {\n    id: text('id').primaryKey(),\n    userId: text('user_id').notNull().references(() => user.id).unique(),\n    companyName: text('company_name'),\n    siret: text('siret'),\n    address: text('address'),\n    email: text('email'),\n    logoUrl: text('logo_url'),\n    legalMentions: text('legal_mentions'),\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n    updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\n// Stripe Accounts - supports multiple Stripe accounts per user\nexport const stripeAccounts = pgTable('stripe_accounts', {\n    id: text('id').primaryKey(),\n    userId: text('user_id').notNull().references(() => user.id, { onDelete: 'cascade' }),\n    name: text('name').notNull(), // e.g., \"SaaS Product A\", \"Consulting\"\n    description: text('description'),\n    stripeAccountId: text('stripe_account_id'), // For Stripe Connect (optional)\n    apiKey: text('api_key').notNull(), // Encrypted\n    webhookSecret: text('webhook_secret'), // Encrypted\n    isActive: boolean('is_active').default(true).notNull(),\n    lastSyncAt: timestamp('last_sync_at'),\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n    updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\n// Products - synced from Stripe\nexport const products = pgTable('products', {\n    id: text('id').primaryKey(),\n    userId: text('user_id').notNull().references(() => user.id, { onDelete: 'cascade' }),\n    stripeAccountId: text('stripe_account_id').notNull().references(() => stripeAccounts.id, { onDelete: 'cascade' }),\n    stripeProductId: text('stripe_product_id').notNull(),\n    stripePriceId: text('stripe_price_id'), // Default price\n    name: text('name').notNull(),\n    description: text('description'),\n    price: decimal('price', { precision: 10, scale: 2 }),\n    currency: text('currency').default('EUR').notNull(),\n    isRecurring: boolean('is_recurring').default(false).notNull(),\n    billingPeriod: text('billing_period'), // 'month', 'year', 'week', 'day'\n    isActive: boolean('is_active').default(true).notNull(),\n    metadata: text('metadata'), // JSON string for additional Stripe metadata\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n    updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\n// Subscriptions - track recurring revenue\nexport const subscriptions = pgTable('subscriptions', {\n    id: text('id').primaryKey(),\n    userId: text('user_id').notNull().references(() => user.id, { onDelete: 'cascade' }),\n    stripeAccountId: text('stripe_account_id').notNull().references(() => stripeAccounts.id, { onDelete: 'cascade' }),\n    clientId: text('client_id').references(() => clients.id, { onDelete: 'set null' }),\n    productId: text('product_id').references(() => products.id, { onDelete: 'set null' }),\n    stripeSubscriptionId: text('stripe_subscription_id').notNull().unique(),\n    stripeCustomerId: text('stripe_customer_id'),\n    status: text('status').notNull(), // 'active', 'canceled', 'past_due', 'unpaid', 'trialing'\n    currentPeriodStart: timestamp('current_period_start'),\n    currentPeriodEnd: timestamp('current_period_end'),\n    cancelAtPeriodEnd: boolean('cancel_at_period_end').default(false).notNull(),\n    canceledAt: timestamp('canceled_at'),\n    amount: decimal('amount', { precision: 10, scale: 2 }),\n    currency: text('currency').default('EUR'),\n    metadata: text('metadata'), // JSON string\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n    updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\n// Stripe Events Log - for debugging and audit trail\nexport const stripeEvents = pgTable('stripe_events', {\n    id: text('id').primaryKey(),\n    stripeAccountId: text('stripe_account_id').references(() => stripeAccounts.id, { onDelete: 'cascade' }),\n    stripeEventId: text('stripe_event_id').notNull().unique(),\n    eventType: text('event_type').notNull(),\n    processed: boolean('processed').default(false).notNull(),\n    error: text('error'),\n    payload: text('payload'), // JSON string of full event\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\n\nexport const monthlyAnalytics = pgTable('monthly_analytics', {\n    // Primary Key\n    id: serial('id').notNull().unique(),\n\n    // Foreign Key to link to the Stripe Account\n    accountId: varchar('account_id')\n        .notNull()\n        .references(() => stripeAccounts.id, { onDelete: 'cascade' }), // If the account is deleted, delete its stats\n\n    // Time Dimension\n    // Store the month as a standardized key (e.g., '2025-11') for easy querying\n    monthKey: varchar('month_key', { length: 7 }).notNull(),\n\n    // --- MRR Metrics (use 'real' for floating-point currency) ---\n    startingMRR: real('starting_mrr').notNull(),\n    endingMRR: real('ending_mrr').notNull(),\n    newMRR: real('new_mrr').notNull(),\n    churnedMRR: real('churned_mrr').notNull(),\n\n    // --- Customer Metrics (use 'integer' for counts) ---\n    startingCustomers: integer('starting_customers').notNull(),\n    endingCustomers: integer('ending_customers').notNull(),\n    newCustomers: integer('new_customers').notNull(),\n    churnedCustomers: integer('churned_customers').notNull(),\n    customerChurnRate: real('customer_churn_rate').notNull(), // Percentage value (e.g., 1.5 for 1.5%)\n\n    // Metadata\n    createdAt: timestamp('created_at').defaultNow().notNull(),\n    updatedAt: timestamp('updated_at').defaultNow().notNull(),\n}, (table) => {\n    return {\n        // Enforce uniqueness for a specific month for a specific account\n        pk: primaryKey({ columns: [table.accountId, table.monthKey] }),\n    }\n});\n\n// --- Table Relations (for Drizzle relations API) ---\n\nexport const monthlyAnalyticsRelations = relations(monthlyAnalytics, ({ one }) => ({\n    // Defines the one-to-many relationship back to the parent Stripe Account\n    stripeAccount: one(stripeAccounts, {\n        fields: [monthlyAnalytics.accountId],\n        references: [stripeAccounts.id],\n    }),\n}));"],"names":[],"mappings":"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"}},
    {"offset": {"line": 437, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/lib/db/drizzle.ts"],"sourcesContent":["import { drizzle } from \"drizzle-orm/neon-http\";\nimport { neon } from \"@neondatabase/serverless\";\nimport { isLocal } from \"@/const\";\nimport * as schema from \"./schema\";\nimport * as authSchema from \"./auth-schema\";\n\nconst DATABASE_URL = isLocal ? process.env.DATABASE_URL_DEV! : process.env.DATABASE_URL!;\nif (!DATABASE_URL) throw new Error(\"Missing DATABASE_URL environment variable\");\nconsole.log({ isLocal, DATABASE_URL });\nconst cleanDatabaseUrl = DATABASE_URL.split('?')[0];\n\nconst sql = neon(cleanDatabaseUrl);\nexport const db = drizzle(sql, { schema: { ...schema, ...authSchema } });\n\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM,eAAe,6KAAO,GAAG,QAAQ,GAAG,CAAC,gBAAgB,GAAI,QAAQ,GAAG,CAAC,YAAY;AACvF,IAAI,CAAC,cAAc,MAAM,IAAI,MAAM;AACnC,QAAQ,GAAG,CAAC;IAAE,SAAA,6KAAO;IAAE;AAAa;AACpC,MAAM,mBAAmB,aAAa,KAAK,CAAC,IAAI,CAAC,EAAE;AAEnD,MAAM,MAAM,IAAA,4MAAI,EAAC;AACV,MAAM,KAAK,IAAA,iNAAO,EAAC,KAAK;IAAE,QAAQ;QAAE,GAAG,gLAAM;QAAE,GAAG,wLAAU;IAAC;AAAE"}},
    {"offset": {"line": 469, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/lib/auth/auth.ts"],"sourcesContent":["import { betterAuth } from \"better-auth\";\nimport { drizzleAdapter } from \"better-auth/adapters/drizzle\";\nimport { nextCookies } from \"better-auth/next-js\";\nimport { db } from \"../db/drizzle\";\nimport { authSchema } from \"../db/auth-schema\";\n\nexport const auth = betterAuth({\n    appName: \"Solopreneur Tool\",\n    database: drizzleAdapter(db, {\n        provider: \"pg\",\n        schema: authSchema,\n    }),\n    trustedOrigins: [\n        \"http://localhost:3000\",\n        \"http://localhost:8081\",\n        \"http://localhost:19006\",\n        \"https://solopreneur.sethylaleye.com\"\n    ],\n    emailAndPassword: {\n        enabled: true,\n    },\n    plugins: [nextCookies()],\n});\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,MAAM,OAAO,IAAA,0PAAU,EAAC;IAC3B,SAAS;IACT,UAAU,IAAA,kPAAc,EAAC,uLAAE,EAAE;QACzB,UAAU;QACV,QAAQ,sMAAU;IACtB;IACA,gBAAgB;QACZ;QACA;QACA;QACA;KACH;IACD,kBAAkB;QACd,SAAS;IACb;IACA,SAAS;QAAC,IAAA,kOAAW;KAAG;AAC5B"}},
    {"offset": {"line": 513, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/lib/api/response.ts"],"sourcesContent":["export function successResponse<T>(data: T, status = 200) {\n    if (status === 204) {\n        return new Response(null, { status });\n    }\n    return Response.json({ data, error: null }, { status });\n}\n\nexport function errorResponse(message: string, status = 400) {\n    return Response.json({ data: null, error: message }, { status });\n}\n"],"names":[],"mappings":";;;;;;AAAO,SAAS,gBAAmB,IAAO,EAAE,SAAS,GAAG;IACpD,IAAI,WAAW,KAAK;QAChB,OAAO,IAAI,SAAS,MAAM;YAAE;QAAO;IACvC;IACA,OAAO,SAAS,IAAI,CAAC;QAAE;QAAM,OAAO;IAAK,GAAG;QAAE;IAAO;AACzD;AAEO,SAAS,cAAc,OAAe,EAAE,SAAS,GAAG;IACvD,OAAO,SAAS,IAAI,CAAC;QAAE,MAAM;QAAM,OAAO;IAAQ,GAAG;QAAE;IAAO;AAClE"}},
    {"offset": {"line": 544, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/lib/api/run-with-auth.ts"],"sourcesContent":["import { auth } from '@/lib/auth/auth';\nimport { User } from 'better-auth';\nimport { headers } from 'next/headers';\nimport { errorResponse } from './response';\n\ntype AuthenticatedAPIHandler<A extends any[]> = (\n    user: User,\n    ...args: A\n) => Promise<Response>;\n\nexport async function runWithAuthAPI<A extends any[]>(\n    handler: AuthenticatedAPIHandler<A>,\n    ...args: A\n): Promise<Response> {\n    try {\n        const session = await auth.api.getSession({\n            headers: await headers(),\n        });\n\n\n        if (!session) {\n            return errorResponse('Unauthorized: User not authenticated.', 401);\n        }\n\n        return await handler(session.user, ...args);\n    } catch (error) {\n        console.error('API Route Error:', error);\n        return errorResponse(\n            error instanceof Error ? error.message : 'Internal server error',\n            500\n        );\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AAEA;AACA;;;;AAOO,eAAe,eAClB,OAAmC,EACnC,GAAG,IAAO;IAEV,IAAI;QACA,MAAM,UAAU,MAAM,wLAAI,CAAC,GAAG,CAAC,UAAU,CAAC;YACtC,SAAS,MAAM,IAAA,wLAAO;QAC1B;QAGA,IAAI,CAAC,SAAS;YACV,OAAO,IAAA,oMAAa,EAAC,yCAAyC;QAClE;QAEA,OAAO,MAAM,QAAQ,QAAQ,IAAI,KAAK;IAC1C,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,IAAA,oMAAa,EAChB,iBAAiB,QAAQ,MAAM,OAAO,GAAG,yBACzC;IAER;AACJ"}},
    {"offset": {"line": 608, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/lib/stripe/encryption.ts"],"sourcesContent":["import crypto from 'crypto';\n\nconst ENCRYPTION_KEY = process.env.ENCRYPTION_KEY;\nconst ALGORITHM = 'aes-256-gcm';\n\nif (!ENCRYPTION_KEY || ENCRYPTION_KEY.length !== 64) {\n    throw new Error('ENCRYPTION_KEY must be a 64-character hex string (32 bytes)');\n}\n\nconst key = Buffer.from(ENCRYPTION_KEY, 'hex');\n\nexport function encrypt(text: string): string {\n    const iv = crypto.randomBytes(16);\n    const cipher = crypto.createCipheriv(ALGORITHM, key, iv);\n\n    let encrypted = cipher.update(text, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n\n    const authTag = cipher.getAuthTag();\n\n    // Format: iv:authTag:encrypted\n    return `${iv.toString('hex')}:${authTag.toString('hex')}:${encrypted}`;\n}\n\nexport function decrypt(encryptedData: string): string {\n    const parts = encryptedData.split(':');\n    if (parts.length !== 3) {\n        throw new Error('Invalid encrypted data format');\n    }\n\n    const [ivHex, authTagHex, encrypted] = parts;\n    const iv = Buffer.from(ivHex, 'hex');\n    const authTag = Buffer.from(authTagHex, 'hex');\n\n    const decipher = crypto.createDecipheriv(ALGORITHM, key, iv);\n    decipher.setAuthTag(authTag);\n\n    let decrypted = decipher.update(encrypted, 'hex', 'utf8');\n    decrypted += decipher.final('utf8');\n\n    return decrypted;\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc;AACjD,MAAM,YAAY;AAElB,IAAI,CAAC,kBAAkB,eAAe,MAAM,KAAK,IAAI;IACjD,MAAM,IAAI,MAAM;AACpB;AAEA,MAAM,MAAM,OAAO,IAAI,CAAC,gBAAgB;AAEjC,SAAS,QAAQ,IAAY;IAChC,MAAM,KAAK,gHAAM,CAAC,WAAW,CAAC;IAC9B,MAAM,SAAS,gHAAM,CAAC,cAAc,CAAC,WAAW,KAAK;IAErD,IAAI,YAAY,OAAO,MAAM,CAAC,MAAM,QAAQ;IAC5C,aAAa,OAAO,KAAK,CAAC;IAE1B,MAAM,UAAU,OAAO,UAAU;IAEjC,+BAA+B;IAC/B,OAAO,GAAG,GAAG,QAAQ,CAAC,OAAO,CAAC,EAAE,QAAQ,QAAQ,CAAC,OAAO,CAAC,EAAE,WAAW;AAC1E;AAEO,SAAS,QAAQ,aAAqB;IACzC,MAAM,QAAQ,cAAc,KAAK,CAAC;IAClC,IAAI,MAAM,MAAM,KAAK,GAAG;QACpB,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,CAAC,OAAO,YAAY,UAAU,GAAG;IACvC,MAAM,KAAK,OAAO,IAAI,CAAC,OAAO;IAC9B,MAAM,UAAU,OAAO,IAAI,CAAC,YAAY;IAExC,MAAM,WAAW,gHAAM,CAAC,gBAAgB,CAAC,WAAW,KAAK;IACzD,SAAS,UAAU,CAAC;IAEpB,IAAI,YAAY,SAAS,MAAM,CAAC,WAAW,OAAO;IAClD,aAAa,SAAS,KAAK,CAAC;IAE5B,OAAO;AACX"}},
    {"offset": {"line": 649, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/lib/stripe/client.ts"],"sourcesContent":["import Stripe from 'stripe';\nimport { db } from '@/lib/db/drizzle';\nimport { stripeAccounts } from '@/lib/db/schema';\nimport { eq } from 'drizzle-orm';\nimport { decrypt } from './encryption';\n\nconst stripeClients = new Map<string, Stripe>();\n\nexport async function getStripeClient(accountId: string): Promise<Stripe> {\n    // Check cache first\n    if (stripeClients.has(accountId)) {\n        return stripeClients.get(accountId)!;\n    }\n\n    // Fetch account from database\n    const account = await db.query.stripeAccounts.findFirst({\n        where: eq(stripeAccounts.id, accountId),\n    });\n\n    if (!account) {\n        throw new Error(`Stripe account not found: ${accountId}`);\n    }\n\n    if (!account.isActive) {\n        throw new Error(`Stripe account is inactive: ${accountId}`);\n    }\n\n    // Decrypt API key and create client\n    const apiKey = decrypt(account.apiKey);\n    const client = new Stripe(apiKey, {\n        apiVersion: '2025-11-17.clover',\n    });\n\n    // Cache the client\n    stripeClients.set(accountId, client);\n\n    return client;\n}\n\nexport function clearStripeClientCache(accountId?: string) {\n    if (accountId) {\n        stripeClients.delete(accountId);\n    } else {\n        stripeClients.clear();\n    }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM,gBAAgB,IAAI;AAEnB,eAAe,gBAAgB,SAAiB;IACnD,oBAAoB;IACpB,IAAI,cAAc,GAAG,CAAC,YAAY;QAC9B,OAAO,cAAc,GAAG,CAAC;IAC7B;IAEA,8BAA8B;IAC9B,MAAM,UAAU,MAAM,uLAAE,CAAC,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC;QACpD,OAAO,IAAA,sNAAE,EAAC,kMAAc,CAAC,EAAE,EAAE;IACjC;IAEA,IAAI,CAAC,SAAS;QACV,MAAM,IAAI,MAAM,CAAC,0BAA0B,EAAE,WAAW;IAC5D;IAEA,IAAI,CAAC,QAAQ,QAAQ,EAAE;QACnB,MAAM,IAAI,MAAM,CAAC,4BAA4B,EAAE,WAAW;IAC9D;IAEA,oCAAoC;IACpC,MAAM,SAAS,IAAA,mMAAO,EAAC,QAAQ,MAAM;IACrC,MAAM,SAAS,IAAI,+MAAM,CAAC,QAAQ;QAC9B,YAAY;IAChB;IAEA,mBAAmB;IACnB,cAAc,GAAG,CAAC,WAAW;IAE7B,OAAO;AACX;AAEO,SAAS,uBAAuB,SAAkB;IACrD,IAAI,WAAW;QACX,cAAc,MAAM,CAAC;IACzB,OAAO;QACH,cAAc,KAAK;IACvB;AACJ"}},
    {"offset": {"line": 701, "column": 0}, "map": {"version":3,"sources":["file:///Users/sethylaleye/Documents/Code/solopreneur-tool/apps/web/app/api/stripe/stats/route.ts"],"sourcesContent":["import { runWithAuthAPI } from \"@/lib/api/run-with-auth\";\nimport { db } from \"@/lib/db/drizzle\";\nimport { monthlyAnalytics, stripeAccounts } from \"@/lib/db/schema\"; // Import the new monthlyAnalytics table\nimport { getStripeClient } from \"@/lib/stripe/client\";\nimport { eq, desc, inArray, sql } from \"drizzle-orm\";\nimport Stripe from \"stripe\";\nimport { successResponse } from \"@/lib/api/response\";\n\n// --- Configuration ---\nconst REPORTING_MONTHS = 12;\n// Data is considered stale if it hasn't been updated in 1 hour (3600000 ms)\nconst STALENESS_THRESHOLD = 60 * 60 * 1000;\n\nconst calculateMRR = (price: Stripe.Price): number => {\n    if (!price || !price.recurring) return 0;\n\n    const amountInCents = price.unit_amount || 0;\n    const interval = price.recurring.interval;\n    const intervalCount = price.recurring.interval_count || 1;\n    const amount = amountInCents / 100;\n\n    switch (interval) {\n        case \"month\":\n            return amount / intervalCount;\n        case \"year\":\n            return (amount / intervalCount) / 12;\n        case \"week\":\n            return (amount / intervalCount) * (52 / 12);\n        default:\n            return 0;\n    }\n};\n\nconst getMonthKey = (date: Date): string => {\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, '0');\n    return `${year}-${month}`;\n};\n\n\n// --- API Endpoint ---\n\nexport async function GET(request: Request) {\n    return runWithAuthAPI(async (user) => {\n\n        // --- 1. Setup Reporting Window and Keys ---\n        const today = new Date();\n        const startDate = new Date();\n        startDate.setDate(1); // Fix: Start from 1st of month to avoid overflow\n        startDate.setMonth(today.getMonth() - REPORTING_MONTHS);\n        const startTimestamp = Math.floor(startDate.getTime() / 1000);\n\n        // Generate the month keys we expect in the DB (for the last 12 months)\n        const expectedMonthKeys: string[] = [];\n        for (let i = 0; i < REPORTING_MONTHS; i++) {\n            const monthKeyDate = new Date(startDate);\n            monthKeyDate.setMonth(monthKeyDate.getMonth() + i + 1);\n            expectedMonthKeys.push(getMonthKey(monthKeyDate));\n        }\n\n        const { searchParams } = new URL(request.url);\n        const forceRefresh = searchParams.get('force_refresh') === 'true';\n\n        const accounts = await db\n            .select({\n                id: stripeAccounts.id,\n                name: stripeAccounts.name,\n            })\n            .from(stripeAccounts)\n            .where(eq(stripeAccounts.userId, user.id));\n\n        const allResults = [];\n\n        for (const acc of accounts) {\n\n            // =======================================================\n            // ðŸš€ CACHING LOGIC: ATTEMPT TO READ FROM DB FIRST\n            // =======================================================\n\n            const cachedAnalytics = await db\n                .select()\n                .from(monthlyAnalytics)\n                .where(inArray(monthlyAnalytics.monthKey, expectedMonthKeys))\n                .orderBy(desc(monthlyAnalytics.monthKey));\n\n            // Check 1: Do we have all the required records?\n            const isComplete = cachedAnalytics.length >= REPORTING_MONTHS;\n\n            // Check 2: Is the most recent record fresh?\n            const mostRecentRecord = cachedAnalytics[0];\n            const isFresh = mostRecentRecord\n                ? (today.getTime() - mostRecentRecord.updatedAt.getTime() < STALENESS_THRESHOLD)\n                : false;\n\n            if (!forceRefresh && isComplete && isFresh) {\n                // Data is complete and fresh, return from cache.\n                const currentMRR = mostRecentRecord.endingMRR;\n                const currentCustomers = mostRecentRecord.endingCustomers;\n\n                allResults.push({\n                    accountId: acc.id,\n                    accountName: acc.name,\n                    monthlyAnalytics: cachedAnalytics.sort((a, b) => (a.monthKey > b.monthKey ? 1 : -1)),\n                    currentSnapshot: {\n                        mrr: currentMRR,\n                        arr: parseFloat((currentMRR * 12).toFixed(2)),\n                        activeCustomers: currentCustomers,\n                    }\n                });\n                continue; // Skip the Stripe API call\n            }\n\n            // =======================================================\n            // ðŸ“‰ FALLBACK LOGIC: CALL STRIPE API & RECALCULATE\n            // =======================================================\n\n            const stripe = await getStripeClient(acc.id);\n\n            // --- 2. Fetch Relevant Subscriptions ---\n            const subscriptions = await stripe.subscriptions.list({\n                limit: 100,\n                created: { gte: startTimestamp },\n                status: 'all',\n                expand: [\"data.items.data.price\"],\n            });\n\n            // --- 3. Initialize Monthly Data Structure ---\n            const monthlyData: {\n                [key: string]: {\n                    newMRR: number;\n                    churnedMRR: number;\n                    newCustomers: Set<string>;\n                    churnedCustomers: Set<string>;\n                }\n            } = {};\n\n            // Re-initialize for all expected months\n            for (const key of expectedMonthKeys) {\n                monthlyData[key] = {\n                    newMRR: 0,\n                    churnedMRR: 0,\n                    newCustomers: new Set(),\n                    churnedCustomers: new Set(),\n                };\n            }\n\n            // --- 4. Process Subscriptions for New/Churn Events (Calculation) ---\n            for (const sub of subscriptions.data) {\n                if (!sub.customer || !sub.items.data.length) continue;\n                const customerId = sub.customer as string;\n\n                // A. Track New MRR\n                const createdMonthKey = getMonthKey(new Date(sub.created * 1000));\n                if (monthlyData[createdMonthKey]) {\n                    for (const item of sub.items.data) {\n                        monthlyData[createdMonthKey].newMRR += calculateMRR(item.price);\n                    }\n                    monthlyData[createdMonthKey].newCustomers.add(customerId);\n                }\n\n                // B. Track Churned MRR\n                if (sub.canceled_at) {\n                    const canceledMonthKey = getMonthKey(new Date(sub.canceled_at * 1000));\n                    if (monthlyData[canceledMonthKey]) {\n                        for (const item of sub.items.data) {\n                            monthlyData[canceledMonthKey].churnedMRR += calculateMRR(item.price);\n                        }\n                        monthlyData[canceledMonthKey].churnedCustomers.add(customerId);\n                    }\n                }\n            }\n\n            // --- 5. Calculate Cumulative/Derived Metrics ---\n            let cumulativeMRR = 0;\n            let cumulativeCustomers = 0;\n            const monthlyResultsArray: typeof monthlyAnalytics.$inferInsert[] = [];\n\n            const sortedMonthKeys = expectedMonthKeys.sort(); // Ensure chronological order\n\n            for (const monthKey of sortedMonthKeys) {\n                const monthData = monthlyData[monthKey];\n\n                const startingMRR = cumulativeMRR;\n                const startingCustomers = cumulativeCustomers;\n\n                // Update Cumulative MRR: (Start + New - Churned)\n                cumulativeMRR += monthData.newMRR - monthData.churnedMRR;\n\n                // Update Cumulative Customers: (Start + New - Churned)\n                const newCustomersCount = monthData.newCustomers.size;\n                const churnedCustomersCount = monthData.churnedCustomers.size;\n                cumulativeCustomers += (newCustomersCount - churnedCustomersCount);\n\n                const customerChurnRate = startingCustomers > 0\n                    ? (churnedCustomersCount / startingCustomers) * 100\n                    : 0;\n\n                // Ensure no negative values\n                cumulativeMRR = Math.max(0, cumulativeMRR);\n                cumulativeCustomers = Math.max(0, cumulativeCustomers);\n\n                // Prepare data for DB and API response\n                monthlyResultsArray.push({\n                    accountId: acc.id,\n                    monthKey: monthKey,\n                    startingMRR: parseFloat(startingMRR.toFixed(2)),\n                    endingMRR: parseFloat(cumulativeMRR.toFixed(2)),\n                    newMRR: parseFloat(monthData.newMRR.toFixed(2)),\n                    churnedMRR: parseFloat(monthData.churnedMRR.toFixed(2)),\n                    startingCustomers: startingCustomers,\n                    endingCustomers: cumulativeCustomers,\n                    newCustomers: newCustomersCount,\n                    churnedCustomers: churnedCustomersCount,\n                    customerChurnRate: parseFloat(customerChurnRate.toFixed(2)),\n                });\n            }\n\n            // --- 6. Persist Data to DB (Upsert) ---\n            if (monthlyResultsArray.length > 0) {\n                // Use insert with onConflictDoUpdate to handle existing records (upsert pattern)\n                await db.insert(monthlyAnalytics)\n                    .values(monthlyResultsArray)\n                    .onConflictDoUpdate({\n                        target: [monthlyAnalytics.accountId, monthlyAnalytics.monthKey],\n                        set: {\n                            startingMRR: sql`excluded.starting_mrr`,\n                            endingMRR: sql`excluded.ending_mrr`,\n                            newMRR: sql`excluded.new_mrr`,\n                            churnedMRR: sql`excluded.churned_mrr`,\n                            startingCustomers: sql`excluded.starting_customers`,\n                            endingCustomers: sql`excluded.ending_customers`,\n                            newCustomers: sql`excluded.new_customers`,\n                            churnedCustomers: sql`excluded.churned_customers`,\n                            customerChurnRate: sql`excluded.customer_churn_rate`,\n                            updatedAt: sql`NOW()`, // Update the timestamp\n                        },\n                    });\n            }\n\n            // --- 7. Compile Final API Response from Calculated Data ---\n            const currentMRR = monthlyResultsArray.length > 0 ? monthlyResultsArray[monthlyResultsArray.length - 1].endingMRR : 0;\n            const currentCustomers = monthlyResultsArray.length > 0 ? monthlyResultsArray[monthlyResultsArray.length - 1].endingCustomers : 0;\n\n            allResults.push({\n                accountId: acc.id,\n                accountName: acc.name,\n                monthlyAnalytics: monthlyResultsArray,\n                currentSnapshot: {\n                    mrr: currentMRR,\n                    arr: parseFloat((currentMRR * 12).toFixed(2)),\n                    activeCustomers: currentCustomers,\n                }\n            });\n        }\n\n        return successResponse(allResults);\n    });\n}"],"names":[],"mappings":"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"}}]
}